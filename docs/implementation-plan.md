# ScalarDB Installer 実装計画書

## 1. ツールの概要

ScalarDB Installerは、ScalarDBおよびScalarDLを簡単にセットアップするためのWebベースのインストールウィザードです。複雑な設定やコマンドライン操作を必要とせず、GUIを通じて直感的にインストールと設定を行うことができます。

## 2. 主な機能

### 2.1 インストールウィザード
- **製品選択**: ScalarDB または ScalarDL の選択
- **環境タイプ**: 開発環境 または 本番環境の選択
- **ステップバイステップ**: 6段階のウィザード形式でインストールを案内

### 2.2 環境チェックと自動インストール
- **Java環境**: OpenJDK 8, 11, 17, 21 の検出とインストール
- **Docker**: Dockerのインストール状態確認
- **ビルドツール**: Maven/Gradleの検出
- **Homebrew**: macOS環境でのパッケージ管理

### 2.3 データベースサポート
- PostgreSQL
- MySQL
- Apache Cassandra
- Amazon DynamoDB
- Azure Cosmos DB

### 2.4 デプロイメントオプション
- **ローカルインストール**: システムに直接インストール
- **Docker**: コンテナ環境での実行
- **Kubernetes**: クラスターでの実行（計画中）

### 2.5 リアルタイム進捗管理
- WebSocketによるリアルタイム進捗更新
- インストールログの表示
- エラー通知とトラブルシューティング

## 3. 現在の実装状況

### ✅ 完了済み機能

#### 3.1 基本インフラ
- [x] Express.jsベースのAPIサーバー
- [x] WebベースのUIウィザード
- [x] Socket.IOによるWebSocket通信
- [x] 設定ファイルの生成と保存

#### 3.2 環境チェック機能
- [x] Java環境の検出（バージョン、ベンダー、JAVA_HOME）
- [x] Dockerの検出と実行状態確認
- [x] Maven/Gradleの検出
- [x] Homebrewの検出（macOS）

#### 3.3 データベース機能
- [x] PostgreSQL接続テスト
- [x] MySQL接続テスト
- [x] Cassandra接続テスト（基本実装）
- [x] DynamoDB接続テスト（AWS SDK使用）
- [x] Cosmos DB接続テスト（Azure SDK使用）
- [x] スキーマ自動作成機能

#### 3.4 設定管理
- [x] database.properties生成
- [x] Docker Compose設定生成
- [x] 設定ファイルの検証

#### 3.5 Docker統合
- [x] Dockerコンテナとしてのデプロイ
- [x] Docker Compose設定の自動生成
- [x] コンテナ健全性チェック
- [x] コンテナログ取得

### ⚠️ 部分的に実装済み

#### 3.6 自動インストール機能
- [△] Java自動インストール（macOSのみ実装）
  - macOS: Homebrew経由でEclipse Temurinをインストール
  - Windows: 未実装
  - Linux: 未実装
- [△] Docker自動インストール（基本実装のみ）
  - インストールスクリプトは存在するが、テストが不十分

#### 3.7 ScalarDB本体のインストール
- [△] JARファイルのダウンロード（モック実装）
- [△] バージョン管理（固定バージョンのみ）

### ❌ 未実装機能

#### 3.8 本番環境対応
- [ ] Kubernetesデプロイメント
- [ ] 高可用性設定
- [ ] クラスター構成
- [ ] バックアップ/リストア機能

#### 3.9 セキュリティ機能
- [ ] SSL/TLS設定
- [ ] 認証・認可設定
- [ ] セキュリティベストプラクティスの自動適用

#### 3.10 監視・運用機能
- [ ] メトリクス収集設定
- [ ] ログ管理設定
- [ ] アラート設定

## 4. インストール可能なコンポーネント

### 4.1 現在インストール可能
1. **Java環境**（macOSのみ）
   - Eclipse Temurin JDK 17
   - Homebrew経由でのインストール

2. **設定ファイル**
   - database.properties
   - docker-compose.yml

3. **データベーススキーマ**
   - PostgreSQL、MySQL、Cassandra用のテーブル作成

4. **Dockerコンテナ**
   - ScalarDBサーバーコンテナ
   - データベースコンテナ（PostgreSQL、MySQL、Cassandra）

### 4.2 将来的にインストール予定
1. **Java環境**（全プラットフォーム）
   - Windows: Chocolatey経由
   - Linux: apt/yum経由

2. **ScalarDB本体**
   - Maven Central Repositoryからの直接ダウンロード
   - バージョン選択機能
   - アップグレード機能

3. **関連ツール**
   - ScalarDB Schema Loader
   - ScalarDB SQL CLI
   - ScalarDB GraphQL

4. **本番環境ツール**
   - Kubernetes Operator
   - Helm Charts
   - Terraform モジュール

## 5. 実装優先順位（非エンジニア向け完全自動化）

### Phase 1（最優先）- 即時実装
1. **ScalarDB本体の自動化**
   - Maven CentralからのJARファイル自動ダウンロード
   - バージョン選択UI（最新版デフォルト）
   - 依存ライブラリの自動解決
   - CLIツールの自動セットアップ

2. **データベース自動インストール**
   - PostgreSQL/MySQLのDockerワンクリックインストール
   - データベース・ユーザーの自動作成
   - 接続情報の自動設定
   - サンプルデータの投入オプション

3. **環境設定の完全自動化**
   - Windows/Linux環境でのJava自動インストール
   - 環境変数の自動設定（JAVA_HOME等）
   - Dockerデスクトップの自動インストール案内
   - すべての設定をGUIで完結

4. **エラーハンドリングの徹底**
   - 非技術者向けエラーメッセージ
   - 図解付きトラブルシューティング
   - 自動リトライとリカバリー機能

### Phase 2（利便性向上）- 2週間以内
1. **統合管理ダッシュボード**
   - すべてのコンポーネントの一元管理
   - ワンクリック起動/停止/再起動
   - ヘルスチェックとステータス表示
   - ログビューアー（フィルタリング機能付き）

2. **ローカルインストールオプション**
   - PostgreSQL/MySQLネイティブインストーラー統合
   - サイレントインストール対応
   - 初期設定の完全自動化

3. **サンプルアプリケーション**
   - デモアプリの自動デプロイ
   - 動作確認用のテストデータ
   - 使い方チュートリアル統合

### Phase 3（運用支援）- 1ヶ月以内
1. **メンテナンス機能**
   - ワンクリックバックアップ/リストア
   - 自動アップデート通知
   - データベース最適化ツール

2. **ユーザー支援**
   - インタラクティブなヘルプシステム
   - 動画チュートリアル統合
   - FAQ自動表示

注: Phase 2（Kubernetes等）は非エンジニア向けには不要のため削除

## 6. 技術スタック

### フロントエンド
- HTML5/CSS3/JavaScript（Vanilla）
- Socket.IO Client
- 今後: React/Vue.jsへの移行を検討

### バックエンド
- Node.js + Express.js
- Socket.IO Server
- 各種データベースドライバー

### インフラ
- Docker/Docker Compose
- 将来: Kubernetes、Terraform

## 7. 制限事項と注意点

### 7.1 現在の制限
1. **プラットフォーム依存**
   - Java自動インストールはmacOSのみ
   - 一部のコマンドはUnix系OSを前提

2. **データベース要件**
   - 接続テストには実際のデータベースが必要
   - クラウドサービス（DynamoDB、Cosmos DB）は認証情報が必要

3. **ネットワーク要件**
   - インターネット接続が必須
   - プロキシ環境では追加設定が必要

### 7.2 セキュリティ考慮事項
1. データベースパスワードは平文で保存される
2. HTTPS未対応（ローカル使用を前提）
3. 認証機能なし

## 8. 今後の展開

### 8.1 エンタープライズ対応
- Active Directory/LDAP統合
- 監査ログ機能
- ロールベースアクセス制御

### 8.2 クラウドネイティブ対応
- AWS/Azure/GCP専用テンプレート
- マネージドサービスとの統合
- サーバーレスデプロイメント

### 8.3 開発者体験の向上
- CLI版の提供
- IDE統合（VSCode、IntelliJ）
- CI/CDパイプライン統合

## 9. サポートとドキュメント

### 9.1 現在提供中
- インストールウィザードUI
- 基本的なREADME
- APIドキュメント（コード内）

### 9.2 今後提供予定
- 詳細なユーザーマニュアル
- トラブルシューティングガイド
- ビデオチュートリアル
- コミュニティフォーラム

## 10. まとめ

ScalarDB Installerは、ScalarDBの導入障壁を大幅に下げることを目的としたツールです。現在は基本的なインストール機能とDocker統合が実装されており、今後は本番環境対応とエンタープライズ機能の追加を予定しています。

継続的な改善により、あらゆる規模の組織がScalarDBを簡単に導入・運用できるようになることを目指します。